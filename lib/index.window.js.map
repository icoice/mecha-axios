{"version":3,"file":"index.window.js","mappings":";;;;;;;AAAA;AACY;;AAEZ;AACA,IAAAA,IAAA,GACI,OAAOC,IAAI,KAAK,WAAW,GAAGA,IAAI,GAClC,OAAOC,MAAM,KAAK,WAAW,GAAGA,MAAM,GACtC,eAAgBC,SAAS;EAHrBC,eAAe,GAAAJ,IAAA,CAAfI,eAAe;EAAEC,WAAW,GAAAL,IAAA,CAAXK,WAAW;AAIpC;;AAEAC,MAAM,CAACC,OAAO,GAAGH,eAAe;AAChCE,0BAA0B,GAAGD,WAAW;AACxCC,yBAAsB,GAAGF,eAAe;;;;;;;ACZ3B;AACb,kBAAkB;AAClB;AACA;AACA;AACA;AACA,CAAC;AACD,kBAAkB;;;;;;;;ACPL;AACb;AACA;AACA,iDAAiD,OAAO;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA;AACA,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AACA,kBAAkB;AAClB,yBAAyB,mBAAO,CAAC,GAAkB;AACnD,cAAc,mBAAO,CAAC,GAAS;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAyE,6BAA6B;AACtG;AACA;AACA,6FAA6F,gBAAgB;AAC7G,+FAA+F,gBAAgB;AAC/G;AACA,uFAAuF,gBAAgB;AACvG;AACA,qEAAqE,eAAe;AACpF,2EAA2E,gBAAgB;AAC3F,uEAAuE,gBAAgB;AACvF,6EAA6E,gBAAgB;AAC7F,8EAA8E,gBAAgB;AAC9F;AACA,+EAA+E,gBAAgB;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAyE;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mHAAmH;AACnH;AACA;AACA;AACA;AACA,qDAAqD;AACrD,iDAAiD,IAAI;AACrD,6CAA6C;AAC7C;AACA;AACA,iEAAiE,uBAAuB;AACxF;AACA;AACA,sGAAsG;AACtG;AACA;AACA;AACA;AACA,iDAAiD,IAAI;AACrD,6CAA6C;AAC7C;AACA,iEAAiE,uBAAuB;AACxF;AACA;AACA,sGAAsG,YAAY;AAClH;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,IAAI;AACrD,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,uBAAuB;AACpF;AACA;AACA,kGAAkG;AAClG;AACA;AACA;AACA;AACA,6CAA6C,IAAI;AACjD,yCAAyC;AACzC;AACA,6DAA6D,uBAAuB;AACpF;AACA;AACA,kGAAkG,YAAY;AAC9G;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,IAAI;AACjD,yCAAyC;AACzC;AACA;AACA;AACA;AACA,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sGAAsG,cAAc,kFAAkF;AACtM;AACA,6BAA6B;AAC7B,yBAAyB;AACzB,qBAAqB;AACrB,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,qBAAqB;AACrB,iBAAiB;AACjB;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,6BAA6B;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA,qCAAqC,SAAS;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gFAAgF,GAAG,kBAAkB,GAAG;AACxG,6BAA6B;AAC7B;AACA;AACA;AACA;AACA,uFAAuF,GAAG,kBAAkB,GAAG;AAC/G,6BAA6B;AAC7B;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,wDAAwD;AAChI;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD;AACxD;AACA;AACA,yDAAyD;AACzD;AACA;AACA,kFAAkF;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,CAAC;AACD,kBAAkB;;;;;;;;ACjgBL;AACb,kBAAkB;AAClB,aAAa,GAAG,iBAAiB,GAAG,kBAAkB,GAAG,WAAW,GAAG,UAAU;AACjF;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV,4BAA4B;AAC5B,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,aAAa;;;;;;;UCxDb;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;;;ACtBa;AACb,kBAAkB;AAClB,kBAAkB,GAAG,sBAAsB;AAC3C,mBAAmB,mBAAO,CAAC,GAAkB;AAC7C,kBAAkB;AAClB,uBAAuB,mBAAO,CAAC,GAAsB;AACrD,sBAAsB;AACtB,kBAAkB","sources":["webpack://crevice-api/./node_modules/abort-controller/browser.js","webpack://crevice-api/./src/AxiosDecorator.ts","webpack://crevice-api/./src/CreviceApi.ts","webpack://crevice-api/./src/tools.ts","webpack://crevice-api/webpack/bootstrap","webpack://crevice-api/./main.ts"],"sourcesContent":["/*globals self, window */\n\"use strict\"\n\n/*eslint-disable @mysticatea/prettier */\nconst { AbortController, AbortSignal } =\n    typeof self !== \"undefined\" ? self :\n    typeof window !== \"undefined\" ? window :\n    /* otherwise */ undefined\n/*eslint-enable @mysticatea/prettier */\n\nmodule.exports = AbortController\nmodule.exports.AbortSignal = AbortSignal\nmodule.exports.default = AbortController\n","\"use strict\";\r\nexports.__esModule = true;\r\nvar AxiosDecorator = /** @class */ (function () {\r\n    function AxiosDecorator() {\r\n    }\r\n    return AxiosDecorator;\r\n}());\r\nexports[\"default\"] = AxiosDecorator;\r\n","\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nexports.__esModule = true;\r\nvar abort_controller_1 = require(\"abort-controller\");\r\nvar tools_1 = require(\"./tools\");\r\nvar CreviceApi = /** @class */ (function () {\r\n    function CreviceApi(options) {\r\n        this.init(options);\r\n    }\r\n    CreviceApi.prototype.init = function (_a) {\r\n        var _this = this;\r\n        var fakeCallBack = _a.fakeCallBack, fakeDelay = _a.fakeDelay, host = _a.host, isFake = _a.isFake, list = _a.list, onBuildPayloadAfter = _a.onBuildPayloadAfter, onBuildPayloadBefore = _a.onBuildPayloadBefore, onDownloadProgress = _a.onDownloadProgress, onExtractPayload = _a.onExtractPayload, onUploadProgress = _a.onUploadProgress, paramsSetDefault = _a.paramsSetDefault, paramsSetDefaultValue = _a.paramsSetDefaultValue, processHeaders = _a.processHeaders, proxy = _a.proxy, rejectSend = _a.rejectSend, request = _a.request, requestProxy = _a.requestProxy, responseEncoding = _a.responseEncoding, responseType = _a.responseType, sendBefore = _a.sendBefore, sendFail = _a.sendFail, sendSuccess = _a.sendSuccess, timeout = _a.timeout, verifyParams = _a.verifyParams;\r\n        // 基础属性\r\n        this.host = (0, tools_1.def)(host, '');\r\n        this.list = (0, tools_1.def)(list, []);\r\n        this.verifyParams = (0, tools_1.def)(verifyParams, true);\r\n        this.paramsSetDefault = (0, tools_1.def)(paramsSetDefault, true);\r\n        this.paramsSetDefaultValue = (0, tools_1.def)(paramsSetDefaultValue, '');\r\n        this.proxy = (0, tools_1.def)(proxy, null);\r\n        this.responseEncoding = (0, tools_1.def)(responseEncoding, 'utf8');\r\n        this.responseType = (0, tools_1.def)(responseType, 'json');\r\n        this.requestMoudle = (0, tools_1.def)(request, null);\r\n        this.requestProxy = (0, tools_1.def)(requestProxy, function () { return _this.requestMoudle; });\r\n        this.timeout = (0, tools_1.def)(timeout, 0);\r\n        // 回调事件\r\n        this.onBuildPayloadAfter = (0, tools_1.def)(onBuildPayloadAfter, function (params) { return params; });\r\n        this.onBuildPayloadBefore = (0, tools_1.def)(onBuildPayloadBefore, function (params) { return params; });\r\n        this.onDownloadProgress = (0, tools_1.def)(onDownloadProgress, null);\r\n        this.onExtractPayload = (0, tools_1.def)(onExtractPayload, function (params) { return params; });\r\n        this.onUploadProgress = (0, tools_1.def)(onUploadProgress, null);\r\n        this.rejectSend = (0, tools_1.def)(rejectSend, function () { return false; });\r\n        this.sendBefore = (0, tools_1.def)(sendBefore, function (params) { return params; });\r\n        this.sendFail = (0, tools_1.def)(sendFail, function (params) { return params; });\r\n        this.sendSuccess = (0, tools_1.def)(sendSuccess, function (params) { return params; });\r\n        this.setHeader = (0, tools_1.def)(processHeaders, function (params) { return params; });\r\n        // 模拟数据设置\r\n        this.fakeCallBack = (0, tools_1.def)(fakeCallBack, function (params) { return params; });\r\n        this.fakeDelay = (0, tools_1.def)(fakeDelay, 80);\r\n        this.isFake = (0, tools_1.def)(isFake, false);\r\n        // 输出API\r\n        this.register();\r\n    };\r\n    // 构建接口\r\n    CreviceApi.prototype.buildRequest = function (item) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a, fakeCallBack, fakeDelay, isFake, onDownloadProgress, onExtractPayload, onUploadProgress, proxy, rejectSend, responseEncoding, responseType, requestProxy, timeout, requestMoudle, fake, method, name, paramMap, path, apiRequest;\r\n            var _this = this;\r\n            return __generator(this, function (_b) {\r\n                _a = this, fakeCallBack = _a.fakeCallBack, fakeDelay = _a.fakeDelay, isFake = _a.isFake, onDownloadProgress = _a.onDownloadProgress, onExtractPayload = _a.onExtractPayload, onUploadProgress = _a.onUploadProgress, proxy = _a.proxy, rejectSend = _a.rejectSend, responseEncoding = _a.responseEncoding, responseType = _a.responseType, requestProxy = _a.requestProxy, timeout = _a.timeout;\r\n                requestMoudle = this.requestMoudle;\r\n                fake = item.fake, method = item.method, name = item.name, paramMap = item.paramMap, path = item.path;\r\n                apiRequest = function (payload) {\r\n                    if (payload === void 0) { payload = {}; }\r\n                    return __awaiter(_this, void 0, void 0, function () {\r\n                        var abort, result;\r\n                        var _this = this;\r\n                        return __generator(this, function (_a) {\r\n                            switch (_a.label) {\r\n                                case 0:\r\n                                    abort = new abort_controller_1[\"default\"]();\r\n                                    payload.signal = { abort: abort };\r\n                                    // 依据条件拒绝发送\r\n                                    if (rejectSend(payload, abort.signal)) {\r\n                                        return [2 /*return*/, Promise.reject(new Error('Reject Api Send'))];\r\n                                    }\r\n                                    // 是否使用虚假数据, 当fake是函数时，执行fake并返回报文（哪怕报文本身就是函数也在函数内返回）\r\n                                    if (!(0, tools_1.is)(fake, null) && !(0, tools_1.is)(fake, 'undefined') && isFake) {\r\n                                        return [2 /*return*/, new Promise(function (resolve) {\r\n                                                setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\r\n                                                    var data, _a, _b;\r\n                                                    return __generator(this, function (_c) {\r\n                                                        switch (_c.label) {\r\n                                                            case 0:\r\n                                                                if (!(fake instanceof Function)) return [3 /*break*/, 2];\r\n                                                                return [4 /*yield*/, fake(payload)];\r\n                                                            case 1:\r\n                                                                _a = _c.sent();\r\n                                                                return [3 /*break*/, 3];\r\n                                                            case 2:\r\n                                                                _a = fake;\r\n                                                                _c.label = 3;\r\n                                                            case 3:\r\n                                                                data = _a;\r\n                                                                _b = resolve;\r\n                                                                return [4 /*yield*/, fakeCallBack(data, __assign({}, item))];\r\n                                                            case 4:\r\n                                                                _b.apply(void 0, [_c.sent()]);\r\n                                                                return [2 /*return*/];\r\n                                                        }\r\n                                                    });\r\n                                                }); }, fakeDelay);\r\n                                            })\r\n                                                .then(function () {\r\n                                                var args = [];\r\n                                                for (var _i = 0; _i < arguments.length; _i++) {\r\n                                                    args[_i] = arguments[_i];\r\n                                                }\r\n                                                return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {\r\n                                                    switch (_a.label) {\r\n                                                        case 0: return [4 /*yield*/, this.sendSuccess.apply(this, args)];\r\n                                                        case 1: return [2 /*return*/, _a.sent()];\r\n                                                    }\r\n                                                }); });\r\n                                            })[\"catch\"](function () {\r\n                                                var args = [];\r\n                                                for (var _i = 0; _i < arguments.length; _i++) {\r\n                                                    args[_i] = arguments[_i];\r\n                                                }\r\n                                                return __awaiter(_this, void 0, void 0, function () { var _a, _b; return __generator(this, function (_c) {\r\n                                                    switch (_c.label) {\r\n                                                        case 0:\r\n                                                            _b = (_a = Promise).reject;\r\n                                                            return [4 /*yield*/, this.sendFail.apply(this, args)];\r\n                                                        case 1: return [2 /*return*/, _b.apply(_a, [(_c.sent()) || new Error('request fail')])];\r\n                                                    }\r\n                                                }); });\r\n                                            })];\r\n                                    }\r\n                                    // 是否替换发送对象\r\n                                    if (!(0, tools_1.is)(requestMoudle, 'function'))\r\n                                        throw '[crevice-api]: sendee参数需function类型';\r\n                                    return [4 /*yield*/, requestProxy(requestMoudle)\r\n                                        // 发送请求\r\n                                    ];\r\n                                case 1:\r\n                                    // 前置判断是否需要切换代理\r\n                                    requestMoudle = _a.sent();\r\n                                    result = requestMoudle(payload);\r\n                                    if (!(result instanceof Promise))\r\n                                        return [2 /*return*/, result];\r\n                                    return [4 /*yield*/, result\r\n                                            .then(function () {\r\n                                            var args = [];\r\n                                            for (var _i = 0; _i < arguments.length; _i++) {\r\n                                                args[_i] = arguments[_i];\r\n                                            }\r\n                                            return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {\r\n                                                switch (_a.label) {\r\n                                                    case 0: return [4 /*yield*/, this.sendSuccess.apply(this, args)];\r\n                                                    case 1: return [2 /*return*/, _a.sent()];\r\n                                                }\r\n                                            }); });\r\n                                        })[\"catch\"](function () {\r\n                                            var args = [];\r\n                                            for (var _i = 0; _i < arguments.length; _i++) {\r\n                                                args[_i] = arguments[_i];\r\n                                            }\r\n                                            return __awaiter(_this, void 0, void 0, function () { var _a, _b; return __generator(this, function (_c) {\r\n                                                switch (_c.label) {\r\n                                                    case 0:\r\n                                                        _b = (_a = Promise).reject;\r\n                                                        return [4 /*yield*/, this.sendFail.apply(this, args)];\r\n                                                    case 1: return [2 /*return*/, _b.apply(_a, [(_c.sent()) || new Error('request fail')])];\r\n                                                }\r\n                                            }); });\r\n                                        })];\r\n                                case 2:\r\n                                    result = _a.sent();\r\n                                    return [2 /*return*/, result];\r\n                            }\r\n                        });\r\n                    });\r\n                };\r\n                return [2 /*return*/, function (data, options) {\r\n                        if (options === void 0) { options = {}; }\r\n                        return __awaiter(_this, void 0, void 0, function () {\r\n                            var query, body, pathParam, payload;\r\n                            return __generator(this, function (_a) {\r\n                                switch (_a.label) {\r\n                                    case 0:\r\n                                        query = options.query, body = options.body, pathParam = options.pathParam;\r\n                                        return [4 /*yield*/, this.buildPayload({\r\n                                                body: body,\r\n                                                data: onExtractPayload(data),\r\n                                                method: method,\r\n                                                name: name,\r\n                                                paramMap: paramMap,\r\n                                                path: path,\r\n                                                pathParam: pathParam,\r\n                                                query: query\r\n                                            })];\r\n                                    case 1:\r\n                                        payload = _a.sent();\r\n                                        // 公共上传进度\r\n                                        if ((0, tools_1.is)(onUploadProgress, 'function')) {\r\n                                            payload.onUploadProgress = onUploadProgress;\r\n                                        }\r\n                                        // 公共下载进度\r\n                                        if ((0, tools_1.is)(onDownloadProgress, 'function')) {\r\n                                            payload.onDownloadProgress = onUploadProgress;\r\n                                        }\r\n                                        // 公共接口代理\r\n                                        if ((0, tools_1.is)(proxy, 'object')) {\r\n                                            payload.proxy = proxy;\r\n                                        }\r\n                                        return [2 /*return*/, apiRequest(__assign(__assign(__assign({}, payload), { responseType: responseType, responseEncoding: responseEncoding, timeout: timeout }), options))];\r\n                                }\r\n                            });\r\n                        });\r\n                    }];\r\n            });\r\n        });\r\n    };\r\n    // 自动选择content-type\r\n    CreviceApi.prototype.autoContentType = function (data) {\r\n        if ((0, tools_1.is)(data, 'object'))\r\n            return 'application/json';\r\n        if ((0, tools_1.is)(data, 'string'))\r\n            return 'text/plain';\r\n        if ((0, tools_1.is)(data, Array))\r\n            return 'application/json';\r\n        if ((0, tools_1.is)(data, FormData))\r\n            return 'multipart/form-data';\r\n        return 'text/plain';\r\n    };\r\n    // 注册\r\n    CreviceApi.prototype.register = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var list;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                list = this.list;\r\n                list.forEach(function (item) {\r\n                    if (item.name in _this) {\r\n                        console.warn(\"[crevice-api]: \\u63A5\\u53E3\".concat(item.name, \"\\u7684\\u547D\\u540D\\u53D1\\u751F\\u51B2\\u7A81\\uFF0C\\u8BF7\\u4FEE\\u6539\\u8BE5\\u540D\\u79F0\"));\r\n                        return item;\r\n                    }\r\n                    _this[item.name] = function (data, options) { return __awaiter(_this, void 0, void 0, function () {\r\n                        var apiCall;\r\n                        return __generator(this, function (_a) {\r\n                            switch (_a.label) {\r\n                                case 0: return [4 /*yield*/, this.buildRequest(item)];\r\n                                case 1:\r\n                                    apiCall = _a.sent();\r\n                                    if (!(item.name in this))\r\n                                        this[item.name] = apiCall;\r\n                                    return [2 /*return*/, apiCall(data, options)];\r\n                            }\r\n                        });\r\n                    }); };\r\n                });\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    // 构建API方法\r\n    CreviceApi.prototype.buildPayload = function (_a) {\r\n        var body = _a.body, data = _a.data, method = _a.method, name = _a.name, paramMap = _a.paramMap, path = _a.path, pathParam = _a.pathParam, query = _a.query;\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _b, host, verifyParams, paramMapJson, ContentType, headers, payloadData, nextPath, supportQueryParams, supportQueryAndBodyParams, defaultUseParamsType, sendData, isSkip, requestData;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        _b = this, host = _b.host, verifyParams = _b.verifyParams;\r\n                        paramMapJson = {};\r\n                        ContentType = this.autoContentType(data);\r\n                        return [4 /*yield*/, this.setHeader({ 'Content-Type': ContentType })];\r\n                    case 1:\r\n                        headers = _c.sent();\r\n                        payloadData = data;\r\n                        nextPath = path;\r\n                        if (verifyParams && (0, tools_1.is)(paramMap, 'undefined') && (0, tools_1.is)(payloadData, 'object')) {\r\n                            throw \"[crevice-api]: \\u63A5\\u53E3\".concat(name, \"\\u9700\\u9884\\u5B9A\\u4E49\\u63A5\\u53E3\\u53C2\\u6570\\uFF08\\u975E\\u5FC5\\u8981\\u5219\\u5C06needParamMap\\u8BBE\\u7F6E\\u4E3Afalse\\uFF09\");\r\n                        }\r\n                        return [4 /*yield*/, this.onBuildPayloadBefore(payloadData)];\r\n                    case 2:\r\n                        // 处理请求报文\r\n                        payloadData = _c.sent();\r\n                        payloadData = this.buildPayloadData(payloadData, paramMap);\r\n                        return [4 /*yield*/, this.onBuildPayloadAfter(payloadData)];\r\n                    case 3:\r\n                        payloadData = _c.sent();\r\n                        // 参数描述\r\n                        if ((0, tools_1.is)(paramMap, Array)) {\r\n                            paramMap.forEach(function (param) {\r\n                                if ((0, tools_1.is)(param, 'object')) {\r\n                                    paramMapJson[param.name] = param;\r\n                                }\r\n                                else {\r\n                                    paramMapJson[param] = { name: param };\r\n                                }\r\n                            });\r\n                        }\r\n                        supportQueryParams = ['GET', 'DELETE', 'OPTIONS ', 'HEAD '];\r\n                        supportQueryAndBodyParams = ['POST', 'PUT', 'PATCH'];\r\n                        defaultUseParamsType = supportQueryParams.includes(method) ? 'query' : 'body';\r\n                        sendData = { query: {}, body: {} };\r\n                        isSkip = false;\r\n                        // GET方法，参数为文件，表单\r\n                        if (((0, tools_1.is)(payloadData, File) ||\r\n                            (0, tools_1.is)(payloadData, FormData)) && defaultUseParamsType === 'query') {\r\n                            throw '请求报文为二进制文件，协议方法需支持body参数';\r\n                        }\r\n                        // GET方法，参数为数组\r\n                        if (((0, tools_1.is)(payloadData, Array) ||\r\n                            (0, tools_1.is)(payloadData, null)) && defaultUseParamsType === 'query') {\r\n                            sendData.query = JSON.stringify(payloadData);\r\n                            isSkip = true;\r\n                        }\r\n                        // POST方法\r\n                        if (((0, tools_1.is)(payloadData, Array) ||\r\n                            (0, tools_1.is)(payloadData, File) ||\r\n                            (0, tools_1.is)(payloadData, FormData) ||\r\n                            (0, tools_1.is)(payloadData, ArrayBuffer) ||\r\n                            (0, tools_1.is)(payloadData, Blob)) && defaultUseParamsType === 'body') {\r\n                            sendData.body = payloadData;\r\n                            isSkip = true;\r\n                        }\r\n                        // JSON对象类型\r\n                        if ((0, tools_1.is)(payloadData, 'object') && !isSkip) {\r\n                            // 通过paramsMap设置默认值\r\n                            Object.keys(payloadData).forEach(function (key) {\r\n                                var v = payloadData[key];\r\n                                var param = paramMapJson[key];\r\n                                var paramType = param ? (param.type || defaultUseParamsType) : defaultUseParamsType;\r\n                                if (paramType === 'body')\r\n                                    sendData.body[key] = v;\r\n                                if (paramType === 'query')\r\n                                    sendData.query[key] = v;\r\n                                if (paramType === 'path')\r\n                                    nextPath = nextPath.replace(new RegExp(\"@\\\\{\\\\{\".concat(key, \"\\\\}\\\\}\"), 'g'), payloadData[key]);\r\n                            });\r\n                        }\r\n                        // 额外参数设置\r\n                        if ((0, tools_1.is)(pathParam, 'object')) {\r\n                            Object.keys(pathParam).forEach(function (key) {\r\n                                nextPath = nextPath = nextPath.replace(new RegExp(\"@\\\\{\\\\{\".concat(key, \"\\\\}\\\\}\"), 'g'), pathParam[key]);\r\n                            });\r\n                        }\r\n                        if ((0, tools_1.is)(query, 'object')) {\r\n                            Object.keys(query).forEach(function (key) {\r\n                                sendData.query[key] = query[key];\r\n                            });\r\n                        }\r\n                        if ((0, tools_1.is)(body, 'object')) {\r\n                            Object.keys(body).forEach(function (key) {\r\n                                sendData.body[key] = body[key];\r\n                            });\r\n                        }\r\n                        requestData = {};\r\n                        if (Object.keys(sendData.body).length > 0)\r\n                            requestData.data = sendData.body;\r\n                        if (Object.keys(sendData.query).length > 0)\r\n                            requestData.params = sendData.query;\r\n                        return [4 /*yield*/, this.sendBefore(__assign({ headers: headers, method: method, url: host + nextPath }, requestData))];\r\n                    case 4: return [2 /*return*/, _c.sent()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    // 处理payload, 类型转换\r\n    CreviceApi.prototype.buildPayloadData = function (data, paramMap) {\r\n        if (data === void 0) { data = {}; }\r\n        if (!(0, tools_1.is)(data, 'object') ||\r\n            (0, tools_1.is)(paramMap, 'undefined') ||\r\n            (0, tools_1.is)(data, File) ||\r\n            (0, tools_1.is)(data, FormData) ||\r\n            (0, tools_1.is)(data, Array) ||\r\n            (0, tools_1.is)(data, ArrayBuffer) ||\r\n            (0, tools_1.is)(data, Blob))\r\n            return data;\r\n        var _a = this, paramsSetDefault = _a.paramsSetDefault, paramsSetDefaultValue = _a.paramsSetDefaultValue;\r\n        var needChagneTypes = [\r\n            'todayStart',\r\n            'todayEnd',\r\n            'todayStartTimestamp',\r\n            'todayEndTimestamp'\r\n        ];\r\n        var canNotChagneTypes = [null, '', undefined];\r\n        var nextData = {};\r\n        var changeDataType = function (param) {\r\n            switch (param.dataType) {\r\n                // 数字\r\n                case 'number':\r\n                    nextData[param.name] = Number(nextData[param.name]);\r\n                    break;\r\n                // 字符\r\n                case 'string':\r\n                    nextData[param.name] = String(nextData[param.name]);\r\n                    break;\r\n                // 时间戳\r\n                case 'timestamp':\r\n                    nextData[param.name] = (0, tools_1.timestamp)(new Date(nextData[param.name]));\r\n                    break;\r\n                // 日期\r\n                case 'date':\r\n                    nextData[param.name] = (0, tools_1.dateFormat)(nextData[param.name]);\r\n                    break;\r\n                // 开始日期\r\n                case 'todayStart':\r\n                    nextData[param.name] = (0, tools_1.today)('start');\r\n                    break;\r\n                // 开始日期时间戳\r\n                case 'todayStartTimestamp':\r\n                    nextData[param.name] = (0, tools_1.timestamp)((0, tools_1.today)('start'));\r\n                    break;\r\n                // 结束日期\r\n                case 'todayEnd':\r\n                    nextData[param.name] = (0, tools_1.today)('end');\r\n                    break;\r\n                // 结束日期时间戳\r\n                case 'todayEndTimestamp':\r\n                    nextData[param.name] = (0, tools_1.timestamp)((0, tools_1.today)('end'));\r\n                    break;\r\n                default:\r\n            }\r\n        };\r\n        // 当报文参数为undefined且paramMap被定义内容时\r\n        if (paramsSetDefault && (0, tools_1.is)(data, 'undefined') && (0, tools_1.is)(paramMap, 'array') && paramMap.length > 0) {\r\n            paramMap.forEach(function (param) {\r\n                var dataType = param instanceof Object && (0, tools_1.is)(param, 'object') ? (param.dataType || '') : '';\r\n                // 数据类型转换\r\n                if (param instanceof Object && (0, tools_1.is)(param, 'object')) {\r\n                    nextData[param.name] = !(0, tools_1.is)(param[\"default\"], 'undefined') ? param[\"default\"] : paramsSetDefaultValue;\r\n                    if (!canNotChagneTypes.includes(nextData[param.name]) || needChagneTypes.includes(dataType)) {\r\n                        changeDataType(param);\r\n                    }\r\n                    return param;\r\n                }\r\n                if (typeof param === 'string') {\r\n                    nextData[param] = paramsSetDefaultValue;\r\n                }\r\n            });\r\n            return nextData;\r\n        }\r\n        // data为object时\r\n        paramMap.forEach(function (param) {\r\n            // param为字符串时, 字符串类型不存在别名\r\n            if (typeof param === 'string') {\r\n                if (paramsSetDefault && (0, tools_1.is)(data[param], 'undefined')) {\r\n                    nextData[param] = paramsSetDefaultValue;\r\n                }\r\n                else if (!(0, tools_1.is)(data[param], 'undefined')) {\r\n                    nextData[param] = data[param];\r\n                }\r\n                return param;\r\n            }\r\n            var aliasName = param.aliasName || '';\r\n            var dataType = param.dataType || '';\r\n            // 存在别名时，从别名中取值，否则在原名中取值，都不存在值时从默认值从取值\r\n            if (!(0, tools_1.is)(data[aliasName], 'undefined')) {\r\n                nextData[param.name] = data[aliasName]; // 别名\r\n            }\r\n            else if (!(0, tools_1.is)(data[param.name], 'undefined')) {\r\n                nextData[param.name] = data[param.name]; // 有值时\r\n            }\r\n            else {\r\n                nextData[param.name] = param[\"default\"] || paramsSetDefaultValue; // 设置缺省值\r\n            }\r\n            // 转换数据类型\r\n            if (!canNotChagneTypes.includes(nextData[param.name]) || needChagneTypes.includes(dataType)) {\r\n                changeDataType(param);\r\n            }\r\n            // 单个字段，假设值为空时，空值要求为null, 而非空字符时的处理\r\n            // 这里主要处理关联字段置空时，需为null的场合\r\n            if ([paramsSetDefaultValue, '', undefined].includes(nextData[param.name]) && param.emptyValueReturnNull) {\r\n                nextData[param.name] = null;\r\n            }\r\n            // 省略非必要上传字段\r\n            if ([paramsSetDefaultValue, '', undefined, null].includes(nextData[param.name]) && param.dispensable) {\r\n                delete nextData[param.name];\r\n            }\r\n        });\r\n        return nextData;\r\n    };\r\n    return CreviceApi;\r\n}());\r\nexports[\"default\"] = CreviceApi;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.today = exports.timestamp = exports.dateFormat = exports.def = exports.is = void 0;\r\nvar is = function (v, t) {\r\n    if (t === void 0) { t = ''; }\r\n    if (t === 'object')\r\n        return typeof v === 'object' && v !== null && !(v instanceof Array);\r\n    if (t === 'promise' || t === Promise)\r\n        return v instanceof Promise || (typeof v === 'object' && v !== null && typeof v.then === 'function' && typeof v[\"catch\"] === 'function');\r\n    if (t === 'null' || t === null)\r\n        return v === null;\r\n    if (t === 'array')\r\n        return v instanceof Array;\r\n    if (t === 'file')\r\n        return v instanceof File;\r\n    if (t === 'formData')\r\n        return v instanceof FormData;\r\n    if (typeof t !== 'string')\r\n        return v instanceof t;\r\n    return typeof v === t;\r\n};\r\nexports.is = is;\r\nvar def = function (v, d) { return (0, exports.is)(v, 'undefined') ? d : v; };\r\nexports.def = def;\r\nvar dateFormat = function (params) {\r\n    var date = new Date(params);\r\n    var y = date.getFullYear();\r\n    var m = date.getMonth() + 1;\r\n    var d = date.getDate();\r\n    var h = date.getHours();\r\n    var i = date.getMinutes();\r\n    var s = date.getSeconds();\r\n    m = m < 10 ? '0' + m : m;\r\n    d = d < 10 ? '0' + d : d;\r\n    h = h < 10 ? '0' + h : h;\r\n    i = i < 10 ? '0' + i : i;\r\n    s = s < 10 ? '0' + s : s;\r\n    return \"\".concat(y, \"-\").concat(m, \"-\").concat(d, \" \").concat(h, \":\").concat(i, \":\").concat(s);\r\n};\r\nexports.dateFormat = dateFormat;\r\nvar timestamp = function (param) {\r\n    return (new Date(param)).getTime();\r\n};\r\nexports.timestamp = timestamp;\r\nvar today = function (key) {\r\n    var date = new Date();\r\n    var y = date.getFullYear();\r\n    var m = date.getMonth() + 1;\r\n    var d = date.getDate();\r\n    m = m < 10 ? '0' + m : m;\r\n    d = d < 10 ? '0' + d : d;\r\n    return ({\r\n        start: \"\".concat(y, \"-\").concat(m, \"-\").concat(d, \" 00:00:00\"),\r\n        end: \"\".concat(y, \"-\").concat(m, \"-\").concat(d, \" 23:59:59\")\r\n    })[key];\r\n};\r\nexports.today = today;\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.CreviceApi = exports.AxiosDecorator = void 0;\r\nvar CreviceApi_1 = require(\"./src/CreviceApi\");\r\nexports.CreviceApi = CreviceApi_1[\"default\"];\r\nvar AxiosDecorator_1 = require(\"./src/AxiosDecorator\");\r\nexports.AxiosDecorator = AxiosDecorator_1[\"default\"];\r\nexports[\"default\"] = CreviceApi_1[\"default\"];\r\n"],"names":["_ref","self","window","undefined","AbortController","AbortSignal","module","exports"],"sourceRoot":""}